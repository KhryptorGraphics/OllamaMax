# OllamaMax Distributed System Security Configuration
security:
  # HTTPS Configuration
  https:
    enabled: true
    port: 8443
    cert_file: "/home/kp/ollamamax/ollama-distributed/certs/server.crt"
    key_file: "/home/kp/ollamamax/ollama-distributed/certs/server.key"
    ca_file: "/home/kp/ollamamax/ollama-distributed/certs/ca.crt"
    min_tls_version: "1.3"
    force_https: true
    
    # HSTS Configuration
    hsts:
      max_age: 31536000
      include_subdomains: true
      preload: true
  
  # Input Validation
  input_validation:
    enabled: true
    max_request_size: 10485760  # 10MB
    max_json_depth: 10
    max_array_length: 1000
    enable_sanitization: true
  
  # SQL Injection Prevention
  sql_protection:
    enabled: true
    validate_all_inputs: true
    use_parameterized_queries: true
  
  # Rate Limiting
  rate_limiting:
    enabled: true
    requests_per_minute: 100
    burst_size: 20
    cleanup_interval: "5m"
  
  # CORS Configuration
  cors:
    enabled: true
    allowed_origins:
      - "https://localhost:8443"
      - "https://127.0.0.1:8443"
    allowed_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
    allowed_headers: ["Content-Type", "Authorization", "X-Requested-With"]
    allow_credentials: true
    max_age: 86400
  
  # Security Headers
  headers:
    content_security_policy: "default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';"
    x_frame_options: "DENY"
    x_content_type_options: "nosniff"
    referrer_policy: "strict-origin-when-cross-origin"
  
  # Certificate Management
  certificates:
    auto_renewal: true
    renewal_threshold: "720h"  # 30 days
    check_interval: "24h"
    backup_enabled: true
    backup_dir: "/home/kp/ollamamax/ollama-distributed/certs/backup"
  
  # Audit Logging
  audit:
    enabled: true
    log_requests: true
    log_sensitive_data: false
    log_file: "/var/log/ollamamax/audit.log"
